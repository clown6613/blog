---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import PostCard from '../components/PostCard.astro';
import Search from '../components/Search.astro';
import SortToggle from '../components/SortToggle.astro';

// å…¬é–‹è¨˜äº‹ã®ã¿å–å¾—ã—ã¦æ—¥ä»˜ã§ã‚½ãƒ¼ãƒˆ
const posts = (await getCollection('posts', ({ data }) => {
  return data.published === true;
})).sort((a, b) =>
  b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const base = import.meta.env.BASE_URL;
---

<BaseLayout title="ã´ãˆã‚ã - ãƒ›ãƒ¼ãƒ ">
  <Header slot="header" />

  <div class="space-y-8">
    <div class="text-center mb-8 md:mb-12">
      <h1 class="text-3xl md:text-5xl font-bold bg-gradient-to-r from-primary to-primary-light bg-clip-text text-transparent mb-3 md:mb-4">
        ã´ãˆã‚ã
      </h1>
      <p class="text-base md:text-lg text-gray-600 dark:text-gray-400 px-4">
        Tech ã¨ Life ã«ã¤ã„ã¦ã€ã´ãˆãŒç¶´ã‚‹æ—¥ã€…ã®è¨˜éŒ²
      </p>
    </div>

    <!-- æ¤œç´¢UI -->
    <Search />

    <!-- ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
    <div class="flex flex-col sm:flex-row justify-center gap-3 sm:gap-4 mb-6 md:mb-8 px-4 sm:px-0">
      <a
        href={`${base}/category/tech`}
        class="px-5 py-3 md:px-6 bg-primary/10 border-2 border-primary hover:bg-primary hover:text-white transition-all font-medium flex items-center justify-center gap-2 rounded-lg text-primary"
      >
        <span>ğŸ’»</span>
        <span>Tech</span>
      </a>
      <a
        href={`${base}/category/hobby`}
        class="px-5 py-3 md:px-6 bg-secondary/10 border-2 border-secondary hover:bg-secondary hover:text-white transition-all font-medium flex items-center justify-center gap-2 rounded-lg text-secondary"
      >
        <span>ğŸŒ¿</span>
        <span>Life</span>
      </a>
    </div>

    {posts.length === 0 ? (
      <div class="text-center py-12">
        <p class="text-gray-600 dark:text-gray-400 text-lg">
          ã¾ã è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚æœ€åˆã®è¨˜äº‹ã‚’ãŠæ¥½ã—ã¿ã«ï¼
        </p>
      </div>
    ) : (
      <>
        <SortToggle />
        <div id="posts-container" class="grid gap-6 md:gap-8">
          {posts.map(post => (
            <div data-date={post.data.pubDate.toISOString()}>
              <PostCard post={post} />
            </div>
          ))}
        </div>
      </>
    )}
  </div>

  <Footer slot="footer" />
</BaseLayout>
